<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>09 - Transducers.md</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
    <style>
        html {
    overflow-x: initial !important;
}

:root {
    --bg-color: #ffffff;
    --text-color: #333333;
    --select-text-bg-color: #B5D6FC;
    --select-text-font-color: auto;
    --monospace: "Lucida Console", Consolas, "Courier", monospace;
}

html {
    font-size: 14px;
    background-color: var(--bg-color);
    color: var(--text-color);
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    -webkit-font-smoothing: antialiased;
}

body {
    margin: 5%;
    padding: 0px;
    height: auto;
    bottom: 0px;
    top: 0px;
    left: 0px;
    right: 0px;
    font-size: 1rem;
    line-height: 1.42857;
    overflow-x: hidden;
    background: inherit;
    tab-size: 4;
    max-width: 100%;
}

iframe {
    margin: auto;
}

a.url {
    word-break: break-all;
}

a:active, a:hover {
    outline: 0px;
}

.in-text-selection, ::selection {
    text-shadow: none;
    background: var(--select-text-bg-color);
    color: var(--select-text-font-color);
}

#write {
    margin: 0px auto;
    height: auto;
    width: inherit;
    word-break: normal;
    overflow-wrap: break-word;
    position: relative;
    white-space: normal;
    overflow-x: visible;
    padding-top: 40px;
}

#write.first-line-indent p {
    text-indent: 2em;
}

#write.first-line-indent li p, #write.first-line-indent p * {
    text-indent: 0px;
}

#write.first-line-indent li {
    margin-left: 2em;
}

.for-image #write {
    padding-left: 8px;
    padding-right: 8px;
}

body.typora-export {
    padding-left: 30px;
    padding-right: 30px;
}

.typora-export .footnote-line, .typora-export li, .typora-export p {
    white-space: pre-wrap;
}

@media screen and (max-width: 500px) {
    body.typora-export {
        padding-left: 0px;
        padding-right: 0px;
    }

    #write {
        padding-left: 20px;
        padding-right: 20px;
    }

    .CodeMirror-sizer {
        margin-left: 0px !important;
    }

    .CodeMirror-gutters {
        display: none !important;
    }
}

#write li > figure:last-child {
    margin-bottom: 0.5rem;
}

#write ol, #write ul {
    position: relative;
}

img {
    max-width: 100%;
    vertical-align: middle;
}

button, input, select, textarea {
    color: inherit;
    font: inherit;
}

input[type="checkbox"], input[type="radio"] {
    line-height: normal;
    padding: 0px;
}

*, ::after, ::before {
    box-sizing: border-box;
}

#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre {
    width: inherit;
}

#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p {
    position: relative;
}

p {
    line-height: inherit;
}

h1, h2, h3, h4, h5, h6 {
    break-after: avoid-page;
    break-inside: avoid;
    orphans: 2;
}

p {
    orphans: 4;
}

h1 {
    font-size: 2rem;
    text-align: center
}

h2 {
    font-size: 1.8rem;
}

h3 {
    font-size: 1.6rem;
}

h4 {
    font-size: 1.4rem;
}

h5 {
    font-size: 1.2rem;
}

h6 {
    font-size: 1rem;
}

.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p {
    margin-top: 1rem;
    margin-bottom: 1rem;
}

.hidden {
    display: none;
}

.md-blockmeta {
    color: rgb(204, 204, 204);
    font-weight: 700;
    font-style: italic;
}

a {
    cursor: pointer;
}

sup.md-footnote {
    padding: 2px 4px;
    background-color: rgba(238, 238, 238, 0.7);
    color: rgb(85, 85, 85);
    border-radius: 4px;
    cursor: pointer;
}

sup.md-footnote a, sup.md-footnote a:hover {
    color: inherit;
    text-transform: inherit;
    text-decoration: inherit;
}

#write input[type="checkbox"] {
    cursor: pointer;
    width: inherit;
    height: inherit;
}

figure {
    overflow-x: auto;
    margin: 1.2em 0px;
    max-width: calc(100% + 16px);
    padding: 0px;
}

figure > table {
    margin: 0px !important;
}

tr {
    break-inside: avoid;
    break-after: auto;
}

thead {
    display: table-header-group;
}

table {
    border-collapse: collapse;
    border-spacing: 0px;
    width: 100%;
    overflow: auto;
    break-inside: auto;
    text-align: left;
}

table.md-table td {
    min-width: 32px;
}

.CodeMirror-gutters {
    border-right: 0px;
    background-color: inherit;
}

.CodeMirror-linenumber {
    user-select: none;
}

.CodeMirror {
    text-align: left;
}

.CodeMirror-placeholder {
    opacity: 0.3;
}

.CodeMirror pre {
    padding: 0px 4px;
}

.CodeMirror-lines {
    padding: 0px;
}

div.hr:focus {
    cursor: none;
}

#write pre {
    white-space: pre-wrap;
}

#write.fences-no-line-wrapping pre {
    white-space: pre;
}

#write pre.ty-contain-cm {
    white-space: normal;
}

.CodeMirror-gutters {
    margin-right: 4px;
}

.md-fences {
    font-size: 0.9rem;
    display: block;
    break-inside: avoid;
    text-align: left;
    overflow: visible;
    white-space: pre;
    background: inherit;
    position: relative !important;
}

.md-diagram-panel {
    width: 100%;
    margin-top: 10px;
    text-align: center;
    padding-top: 0px;
    padding-bottom: 8px;
    overflow-x: auto;
}

#write .md-fences.mock-cm {
    white-space: pre-wrap;
}

.md-fences.md-fences-with-lineno {
    padding-left: 0px;
}

#write.fences-no-line-wrapping .md-fences.mock-cm {
    white-space: pre;
    overflow-x: auto;
}

.md-fences.mock-cm.md-fences-with-lineno {
    padding-left: 8px;
}

.CodeMirror-line, twitterwidget {
    break-inside: avoid;
}

.footnotes {
    opacity: 0.8;
    font-size: 0.9rem;
    margin-top: 1em;
    margin-bottom: 1em;
}

.footnotes + .footnotes {
    margin-top: 0px;
}

.md-reset {
    margin: 0px;
    padding: 0px;
    border: 0px;
    outline: 0px;
    vertical-align: top;
    background: 0px 0px;
    text-decoration: none;
    text-shadow: none;
    float: none;
    position: static;
    width: auto;
    height: auto;
    white-space: nowrap;
    cursor: inherit;
    -webkit-tap-highlight-color: transparent;
    line-height: normal;
    font-weight: 400;
    text-align: left;
    box-sizing: content-box;
    direction: ltr;
}

li div {
    padding-top: 0px;
}

blockquote {
    margin: 1rem 0px;
}

li .mathjax-block, li p {
    margin: 0.5rem 0px;
}

li {
    margin: 0px;
    position: relative;
}

blockquote > :last-child {
    margin-bottom: 0px;
}

blockquote > :first-child, li > :first-child {
    margin-top: 0px;
}

.footnotes-area {
    color: rgb(136, 136, 136);
    margin-top: 0.714rem;
    padding-bottom: 0.143rem;
    white-space: normal;
}

#write .footnote-line {
    white-space: pre-wrap;
}

@media print {
    body, html {
        border: 1px solid transparent;
        height: 99%;
        break-after: avoid;
        break-before: avoid;
    }

    #write {
        margin-top: 0px;
        padding-top: 0px;
        border-color: transparent !important;
    }

    .typora-export * {
        -webkit-print-color-adjust: exact;
    }

    html.blink-to-pdf {
        font-size: 13px;
    }

    .typora-export #write {
        padding-left: 32px;
        padding-right: 32px;
        padding-bottom: 0px;
        break-after: avoid;
    }

    .typora-export #write::after {
        height: 0px;
    }
}

.footnote-line {
    margin-top: 0.714em;
    font-size: 0.7em;
}

a img, img a {
    cursor: pointer;
}

pre.md-meta-block {
    font-size: 0.8rem;
    min-height: 0.8rem;
    white-space: pre-wrap;
    background: rgb(204, 204, 204);
    display: block;
    overflow-x: hidden;
}

p > .md-image:only-child:not(.md-img-error) img, p > img:only-child {
    display: block;
    margin: auto;
}

p > .md-image:only-child {
    display: inline-block;
    width: 100%;
}

#write .MathJax_Display {
    margin: 0.8em 0px 0px;
}

.md-math-block {
    width: 100%;
}

.md-math-block:not(:empty)::after {
    display: none;
}

[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus {
    outline: 0px;
    box-shadow: none;
}

.md-task-list-item {
    position: relative;
    list-style-type: none;
}

.task-list-item.md-task-list-item {
    padding-left: 0px;
}

.md-task-list-item > input {
    position: absolute;
    top: 0px;
    left: 0px;
    margin-left: -1.2em;
    margin-top: calc(1em - 10px);
    border: none;
}

.math {
    font-size: 1rem;
}

.md-toc {
    min-height: 3.58rem;
    position: relative;
    font-size: 0.9rem;
    border-radius: 10px;
}

.md-toc-content {
    position: relative;
    margin-left: 0px;
}

.md-toc-content::after, .md-toc::after {
    display: none;
}

.md-toc-item {
    display: block;
    color: rgb(65, 131, 196);
}

.md-toc-item a {
    text-decoration: none;
}

.md-toc-inner:hover {
    text-decoration: underline;
}

.md-toc-inner {
    display: inline-block;
    cursor: pointer;
}

.md-toc-h1 .md-toc-inner {
    margin-left: 0px;
    font-weight: 700;
}

.md-toc-h2 .md-toc-inner {
    margin-left: 2em;
}

.md-toc-h3 .md-toc-inner {
    margin-left: 4em;
}

.md-toc-h4 .md-toc-inner {
    margin-left: 6em;
}

.md-toc-h5 .md-toc-inner {
    margin-left: 8em;
}

.md-toc-h6 .md-toc-inner {
    margin-left: 10em;
}

@media screen and (max-width: 48em) {
    .md-toc-h3 .md-toc-inner {
        margin-left: 3.5em;
    }

    .md-toc-h4 .md-toc-inner {
        margin-left: 5em;
    }

    .md-toc-h5 .md-toc-inner {
        margin-left: 6.5em;
    }

    .md-toc-h6 .md-toc-inner {
        margin-left: 8em;
    }
}

a.md-toc-inner {
    font-size: inherit;
    font-style: inherit;
    font-weight: inherit;
    line-height: inherit;
}

.footnote-line a:not(.reversefootnote) {
    color: inherit;
}

.md-attr {
    display: none;
}

.md-fn-count::after {
    content: ".";
}

code, pre, samp, tt {
    font-family: var(--monospace);
}

kbd {
    margin: 0px 0.1em;
    padding: 0.1em 0.6em;
    font-size: 0.8em;
    color: rgb(36, 39, 41);
    background: rgb(255, 255, 255);
    border: 1px solid rgb(173, 179, 185);
    border-radius: 3px;
    box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset;
    white-space: nowrap;
    vertical-align: middle;
}

.md-comment {
    color: rgb(162, 127, 3);
    opacity: 0.8;
    font-family: var(--monospace);
}

code {
    text-align: left;
    vertical-align: initial;
}

a.md-print-anchor {
    white-space: pre !important;
    border-width: initial !important;
    border-style: none !important;
    border-color: initial !important;
    display: inline-block !important;
    position: absolute !important;
    width: 1px !important;
    right: 0px !important;
    outline: 0px !important;
    background: 0px 0px !important;
    text-decoration: initial !important;
    text-shadow: initial !important;
}

.md-inline-math .MathJax_SVG .noError {
    display: none !important;
}

.html-for-mac .inline-math-svg .MathJax_SVG {
    vertical-align: 0.2px;
}

.md-math-block .MathJax_SVG_Display {
    text-align: center;
    margin: 0px;
    position: relative;
    text-indent: 0px;
    max-width: none;
    max-height: none;
    min-height: 0px;
    min-width: 100%;
    width: auto;
    overflow-y: hidden;
    display: block !important;
}

.MathJax_SVG_Display, .md-inline-math .MathJax_SVG_Display {
    width: auto;
    margin: inherit;
    display: inline-block !important;
}

.MathJax_SVG .MJX-monospace {
    font-family: var(--monospace);
}

.MathJax_SVG .MJX-sans-serif {
    font-family: sans-serif;
}

.MathJax_SVG {
    display: inline;
    font-style: normal;
    font-weight: 400;
    line-height: normal;
    zoom: 90%;
    text-indent: 0px;
    text-align: left;
    text-transform: none;
    letter-spacing: normal;
    word-spacing: normal;
    overflow-wrap: normal;
    white-space: nowrap;
    float: none;
    direction: ltr;
    max-width: none;
    max-height: none;
    min-width: 0px;
    min-height: 0px;
    border: 0px;
    padding: 0px;
    margin: 0px;
}

.MathJax_SVG * {
    transition: none 0s ease 0s;
}

.MathJax_SVG_Display svg {
    vertical-align: middle !important;
    margin-bottom: 0px !important;
    margin-top: 0px !important;
}

.os-windows.monocolor-emoji .md-emoji {
    font-family: "Segoe UI Symbol", sans-serif;
}

.md-diagram-panel > svg {
    max-width: 100%;
}

[lang="flow"] svg, [lang="mermaid"] svg {
    max-width: 100%;
    height: auto;
}

[lang="mermaid"] .node text {
    font-size: 1rem;
}

table tr th {
    border-bottom: 0px;
}

video {
    max-width: 100%;
    display: block;
    margin: 0px auto;
}

iframe {
    max-width: 100%;
    width: 100%;
    border: none;
}

.highlight td, .highlight tr {
    border: 0px;
}

svg[id^="mermaidChart"] {
    line-height: 1em;
}

mark {
    background: rgb(255, 255, 0);
    color: rgb(0, 0, 0);
}

.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong {
    color: inherit;
}

mark .md-meta {
    color: rgb(0, 0, 0);
    opacity: 0.3 !important;
}


.CodeMirror {
    height: auto;
}

.CodeMirror.cm-s-inner {
    background: inherit;
}

.CodeMirror-scroll {
    overflow: auto hidden;
    z-index: 3;
}

.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler {
    background-color: rgb(255, 255, 255);
}

.CodeMirror-gutters {
    border-right: 1px solid rgb(221, 221, 221);
    background: inherit;
    white-space: nowrap;
}

.CodeMirror-linenumber {
    padding: 0px 3px 0px 5px;
    text-align: right;
    color: rgb(153, 153, 153);
}

.cm-s-inner .cm-keyword {
    color: rgb(119, 0, 136);
}

.cm-s-inner .cm-atom, .cm-s-inner.cm-atom {
    color: rgb(34, 17, 153);
}

.cm-s-inner .cm-number {
    color: rgb(17, 102, 68);
}

.cm-s-inner .cm-def {
    color: rgb(0, 0, 255);
}

.cm-s-inner .cm-variable {
    color: rgb(0, 0, 0);
}

.cm-s-inner .cm-variable-2 {
    color: rgb(0, 85, 170);
}

.cm-s-inner .cm-variable-3 {
    color: rgb(0, 136, 85);
}

.cm-s-inner .cm-string {
    color: rgb(170, 17, 17);
}

.cm-s-inner .cm-property {
    color: rgb(0, 0, 0);
}

.cm-s-inner .cm-operator {
    color: rgb(152, 26, 26);
}

.cm-s-inner .cm-comment, .cm-s-inner.cm-comment {
    color: rgb(170, 85, 0);
}

.cm-s-inner .cm-string-2 {
    color: rgb(255, 85, 0);
}

.cm-s-inner .cm-meta {
    color: rgb(85, 85, 85);
}

.cm-s-inner .cm-qualifier {
    color: rgb(85, 85, 85);
}

.cm-s-inner .cm-builtin {
    color: rgb(51, 0, 170);
}

.cm-s-inner .cm-bracket {
    color: rgb(153, 153, 119);
}

.cm-s-inner .cm-tag {
    color: rgb(17, 119, 0);
}

.cm-s-inner .cm-attribute {
    color: rgb(0, 0, 204);
}

.cm-s-inner .cm-header, .cm-s-inner.cm-header {
    color: rgb(0, 0, 255);
}

.cm-s-inner .cm-quote, .cm-s-inner.cm-quote {
    color: rgb(0, 153, 0);
}

.cm-s-inner .cm-hr, .cm-s-inner.cm-hr {
    color: rgb(153, 153, 153);
}

.cm-s-inner .cm-link, .cm-s-inner.cm-link {
    color: rgb(0, 0, 204);
}

.cm-negative {
    color: rgb(221, 68, 68);
}

.cm-positive {
    color: rgb(34, 153, 34);
}

.cm-header, .cm-strong {
    font-weight: 700;
}

.cm-del {
    text-decoration: line-through;
}

.cm-em {
    font-style: italic;
}

.cm-link {
    text-decoration: underline;
}

.cm-error {
    color: red;
}

.cm-invalidchar {
    color: red;
}

.cm-constant {
    color: rgb(38, 139, 210);
}

.cm-defined {
    color: rgb(181, 137, 0);
}

div.CodeMirror span.CodeMirror-matchingbracket {
    color: rgb(0, 255, 0);
}

div.CodeMirror span.CodeMirror-nonmatchingbracket {
    color: rgb(255, 34, 34);
}

.cm-s-inner .CodeMirror-activeline-background {
    background: inherit;
}

.CodeMirror {
    position: relative;
    overflow: hidden;
}

.CodeMirror-scroll {
    height: 100%;
    outline: 0px;
    position: relative;
    box-sizing: content-box;
    background: inherit;
}

.CodeMirror-sizer {
    position: relative;
}

.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar {
    position: absolute;
    z-index: 6;
    display: none;
}

.CodeMirror-vscrollbar {
    right: 0px;
    top: 0px;
    overflow: hidden;
}

.CodeMirror-hscrollbar {
    bottom: 0px;
    left: 0px;
    overflow: hidden;
}

.CodeMirror-scrollbar-filler {
    right: 0px;
    bottom: 0px;
}

.CodeMirror-gutter-filler {
    left: 0px;
    bottom: 0px;
}

.CodeMirror-gutters {
    position: absolute;
    left: 0px;
    top: 0px;
    padding-bottom: 30px;
    z-index: 3;
}

.CodeMirror-gutter {
    white-space: normal;
    height: 100%;
    box-sizing: content-box;
    padding-bottom: 30px;
    margin-bottom: -32px;
    display: inline-block;
}

.CodeMirror-gutter-wrapper {
    position: absolute;
    z-index: 4;
    background: 0px 0px !important;
    border: none !important;
}

.CodeMirror-gutter-background {
    position: absolute;
    top: 0px;
    bottom: 0px;
    z-index: 4;
}

.CodeMirror-gutter-elt {
    position: absolute;
    cursor: default;
    z-index: 4;
}

.CodeMirror-lines {
    cursor: text;
}

.CodeMirror pre {
    border-radius: 0px;
    border-width: 0px;
    background: 0px 0px;
    font-family: inherit;
    font-size: inherit;
    margin: 0px;
    white-space: pre;
    overflow-wrap: normal;
    color: inherit;
    z-index: 2;
    position: relative;
    overflow: visible;
}

.CodeMirror-wrap pre {
    overflow-wrap: break-word;
    white-space: pre-wrap;
    word-break: normal;
}

.CodeMirror-code pre {
    border-right: 30px solid transparent;
    width: fit-content;
}

.CodeMirror-wrap .CodeMirror-code pre {
    border-right: none;
    width: auto;
}

.CodeMirror-linebackground {
    position: absolute;
    left: 0px;
    right: 0px;
    top: 0px;
    bottom: 0px;
    z-index: 0;
}

.CodeMirror-linewidget {
    position: relative;
    z-index: 2;
    overflow: auto;
}

.CodeMirror-wrap .CodeMirror-scroll {
    overflow-x: hidden;
}

.CodeMirror-measure {
    position: absolute;
    width: 100%;
    height: 0px;
    overflow: hidden;
    visibility: hidden;
}

.CodeMirror-measure pre {
    position: static;
}

.CodeMirror div.CodeMirror-cursor {
    position: absolute;
    visibility: hidden;
    border-right: none;
    width: 0px;
}

.CodeMirror div.CodeMirror-cursor {
    visibility: hidden;
}

.CodeMirror-focused div.CodeMirror-cursor {
    visibility: inherit;
}

.cm-searching {
    background: rgba(255, 255, 0, 0.4);
}

@media print {
    .CodeMirror div.CodeMirror-cursor {
        visibility: hidden;
    }
}


:root {
    --side-bar-bg-color: white;
    --window-border: none;
    --search-select-bg-color: #575c61;
    --active-file-bg-color: #f1f4f5;
    --item-hover-bg-color: #f1f4f5;
    --item-hover-text-color: black;
    --control-text-color: #555;
}

@include-when-export url(https://raw.githubusercontent.com/slashfoo/lmweb/master/style/latinmodern-mono-light.css);

html {
    font-size: 12pt;
}

#write {
    font-family: "STIX2Text", "Times New Roman", "serif";
    line-height: 1.5em;
    padding: 10%;
    padding-top: 5%;
}

.file-list-item-summary {
    height: 36px;
}

.file-list-item {
    padding-top: 18px !important;
    padding-bottom: 18px;
}

#sidebar-loading-template.file-list-item {
    padding-top: 0 !important;
}

a, a:visited {
    color: #a00;
}

h1, h2, h3, h4, h5, h6 {
    font-family: inherit;
    line-height: 1.5em;
    margin-bottom: 1em;
    margin-top: 1em;
}

h1 {
    font-size: 2.4em;
}

#write h1 {
    text-align: center;
}

h2 {
    font-size: 1.8em;
}

h3 {
    font-size: 1.4em;
}

h4 {
    font-size: 1.2em;
}

h5 {
    font-size: 1.1em;
}

h6 {
    font-size: 1em;
}

p {
    margin-top: 1em;
    margin-bottom: 1em;
    text-align: justify;
}

pre, code {
    font-family: 'Latin Modern Mono Light', "Latin Modern Mono", monospace !important;
    background-color: #ebebeb;
}

.footnotes {
    display: list-item;
    margin-left: 1em;
}

.md-fences {
    border: 1px solid;
}

.md-fences.md-fences-with-lineno {
    border: none;
}

.CodeMirror-linenumber {
    color: #333;
}

*.in-text-selection,
::selection,
.CodeMirror-selected {
    background: var(--search-select-bg-color);
    color: var(--search-select-text-color) !important;
    text-shadow: none;
}

a.md-toc-inner {
    color: var(--text-color);
}

.cm-s-typora-default .cm-link {
    color: #a00;
    text-decoration: underline;
}

.cm-s-typora-default .cm-header, .cm-s-typora-default .cm-property {
    color: black;
}

#typora-source .CodeMirror-lines {
    -webkit-font-smoothing: auto;
    max-width: 1000px;
}

.md-def-name:before,
.md-def-name:after {
    color: #2d2d2d;
}

sup.md-footnote {
    background-color: initial;
    color: inherit;
}

mark {
    background: #fff387;
}

td, th {
    border: 1px solid;
    padding-left: 1ch;
    padding-right: 1ch;
}

/*table tr[cid]:first-child > td {
    border-top: 3px double;
}*/

th {
    border-bottom: 0;
    padding-top: 2px;
    background: #575c61;
    border-color: #333;
    color: #f3f3f3;
}

pre.md-meta-block {
    border: 1px solid #a2a9b1;
    background-color: #f8f9fa;
    padding: 5px;
    margin-bottom: 1em;
}

.task-list-item input:before {
    content: '\221A';
    display: inline-block;
    width: 1.25rem;
    height: 1.6rem;
    vertical-align: middle;
    text-align: center;
    color: #bbb;
    background-color: inherit;
}

.task-list-item input:checked:before,
.task-list-item input[checked]:before {
    color: inherit;
}

.md-task-list-item > input {
    top: auto;
    margin-left: -1.1em;
    font-size: 1.3em;
    margin-top: 0px;
    -webkit-appearance: none;
}

.md-task-list-item input:before {
    content: '\2610';
    display: inline-block;
    width: 1.25rem;
    height: 1.6rem;
    vertical-align: middle;
    text-align: center;
    color: #bbb;
    background-color: inherit;
}

.md-task-list-item input:checked:before,
.md-task-list-item input[checked]:before {
    color: inherit;
    content: '\2611';
}

.task-list-item {
    padding-left: 1.5em;
}

blockquote {
    font-style: italic;
    padding: 0.25em 24px;
    position: relative;
    color: #383838;
    border-left: 2px solid;
}

#write > blockquote {
    padding: 0.25em 30px;
    margin-left: -32px;
    width: calc(100% + 32px);
}

#write > .md-fences-with-lineno {
    margin-left: -33px;
    color: black;
}

.CodeMirror-linenumber {
    min-width: 25px;
}

.md-header {
    font-size: inherit !important;
}

/*blockquote:before {
    display: block;
    content: "\201C";
    font-size: 80px;
    position: absolute;
    left: -20px;
    top: -20px;
    color: #7a7a7a;
}*/




    </style>
</head>
<body>
<h1 id="transducers">Transducers</h1>
<p>A <strong>formal translation</strong> is a binary relation <span class="math">\(Z \subseteq L \times V\)</span> where the domain is the set <span class="math">\(L\)</span> and the range is the set <span class="math">\(V\)</span>. The relation <span class="math">\(Z\)</span> maps a set of translations <span class="math">\(Z(w) \subseteq V\)</span> to each element <span class="math">\(w\)</span> of the set <span class="math">\(L\)</span>. If <span class="math">\(Z(w)\)</span> contains at most one element for every <span class="math">\(w\in L\)</span>, the set <span class="math">\(Z\)</span> is a function and the translation is an <strong>unambiguous translation</strong>.</p>
<p>Let <span class="math">\(\Sigma, D\)</span> be alphabets, an <strong>homomorphism</strong> is every mapping <span class="math">\(h\)</span> from <span class="math">\(\Sigma\)</span> to <span class="math">\(D^*\)</span>. The domain of homomorphism <span class="math">\(h\)</span> can be extended to <span class="math">\(\Sigma^*\)</span> as follows:</p>
<div class="math">
\[
\array{
h(\epsilon) = \epsilon\\
h(xa) = h(x)h(a) &amp; \forall x\in \Sigma^*, \forall a \in \Sigma

}
\]</div>
<p>It is basically an injective translation.</p>
<p>A <strong>prefix</strong> and <strong>postfix</strong> notation of an expression <span class="math">\(E\)</span>:</p>
<ol>
<li>if <span class="math">\(E\)</span> is a variable or a constant, then the prefix or postfix notation of <span class="math">\(E\)</span> is <span class="math">\(E\)</span>.</li>
<li>If <span class="math">\(E\)</span> is an expression of the form <span class="math">\(E_1~op~E_2\)</span> where <span class="math">\(op\)</span> is a binary operator, then:
<ol>
<li><span class="math">\(op~E_1'~E_2'\)</span> is a prefix notation of <span class="math">\(E\)</span>, where <span class="math">\(E_1'\)</span> and <span class="math">\(E_2'\)</span> are prefix notations of <span class="math">\(E_1\)</span> and <span class="math">\(E_2\)</span></li>
<li><span class="math">\(E_1''~E_2''~op\)</span> is a postfix notation of <span class="math">\(E\)</span>, where <span class="math">\(E_1''\)</span> and <span class="math">\(E_2''\)</span> are postfix notations of <span class="math">\(E_1\)</span> and <span class="math">\(E_2\)</span>.</li>
</ol>
</li>
<li>If <span class="math">\(E\)</span> is an expression of the form <span class="math">\((E_1)\)</span>, then:
<ol>
<li><span class="math">\(E_1'\)</span> is a prefix notation of <span class="math">\(E\)</span>, where <span class="math">\(E_1'\)</span> is a prefix notation of <span class="math">\(E_1\)</span>.</li>
<li><span class="math">\(E_1''\)</span> is a postfix notation of <span class="math">\(E\)</span>, where <span class="math">\(E_1''\)</span> is a postfix notation of <span class="math">\(E_1\)</span>.</li>
</ol>
</li>
</ol>
<h2 id="translation-grammar">Translation Grammar</h2>
<p>A <strong>translation grammar</strong> is <span class="math">\(TG = (N,\Sigma,D,R,S)\)</span> where:</p>
<ul>
<li><span class="math">\(N\)</span> is a finite set of nonterminal symbols</li>
<li><span class="math">\(\Sigma\)</span> is a finite set of input symbols</li>
<li><span class="math">\(D\)</span> is a finite set of output symbols</li>
<li><span class="math">\(R\)</span> is a finite set of rules in the form <span class="math">\(A \rightarrow \alpha\)</span> where <span class="math">\(A \in N\)</span></li>
<li><span class="math">\(S \in N\)</span> is the starting symbol</li>
</ul>
<p>For a given <span class="math">\(TG\)</span>, we say that <span class="math">\(\alpha\)</span> derives in one step to <span class="math">\(\beta\)</span>:</p>
<div class="math">
\[
\alpha \Rightarrow \beta
\]</div>
<p>if <span class="math">\(\exists \tau,w,\gamma \in (N \cup\Sigma \cup D)^*,\exists A \in N\)</span>:</p>
<div class="math">
\[
 \alpha = \tau A w, \beta = \tau \gamma w, (A \rightarrow \gamma) \in R
\]</div>
<p>We say that <span class="math">\(\alpha\)</span> derives <span class="math">\(\beta\)</span>:</p>
<div class="math">
\[
\alpha \Rightarrow^* \beta 
\]</div>
<p>If <span class="math">\(\exists \alpha_1,\dots,\alpha_n \in (N \cup\Sigma\cup D)^*, n\ge1\)</span>:</p>
<div class="math">
\[
\alpha = \alpha_1 \Rightarrow\alpha_2 \Rightarrow \dots \Rightarrow \alpha_n = \beta
\]</div>
<p>The sequence <span class="math">\(\alpha_1,\dots,\alpha_n\)</span> is called <strong>translation derivation</strong> of length <span class="math">\(n\)</span> if string <span class="math">\(\beta\)</span> from string <span class="math">\(\alpha\)</span>.</p>
<p>We can also have a <strong>transitive closure</strong> <span class="math">\((\Rightarrow^+)\)</span> and a <strong>transitive and reflexive closure</strong> <span class="math">\((\Rightarrow^*)\)</span>.</p>
<p>For a translation grammar <span class="math">\(TG = (N,\Sigma,D,R,S)\)</span>, an <strong>input homomorphism</strong> is defined as:</p>
<div class="math">
\[
h^{TG}_i(a) = 
\left\{
\array{
a&amp;\forall a \in \Sigma\cup N\\
\epsilon&amp; \forall a \in D
}
\right.\\
h_i^{TG}(x) = h_i^{TG}(x_1) \times \dots \times h_i^{TG}(x_n),~~\forall x_j\in (\Sigma \cup N \cup D)^*
\]</div>
<p>We can also define an <strong>output homomorphism</strong>:</p>
<div class="math">
\[
h^{TG}_0(a) = \left\{\array{\epsilon&amp;\forall a \in \Sigma\\ a&amp; \forall a \in D \cup N}\right.\\h_o^{TG}(x) = h_o^{TG}(x_1) \times \dots \times h_o^{TG}(x_n),~~\forall x_j\in (\Sigma \cup N \cup D)^*
\]</div>
<p>A <strong>translation defined by a translation grammar</strong> <span class="math">\(TG = (N,\Sigma,D,R,S)\)</span> is:</p>
<div class="math">
\[
Z(TG) = \{(h_i^{YG}(w),h_O^{TG}(w)):w \in (\Sigma \cup D)^*, S \Rightarrow^*w\}
\]</div>
<p>An <strong>Input translation grammar</strong> <span class="math">\(TG\)</span> is a Context-Free Grammar <span class="math">\(G_i = (N,\Sigma,P_i,S)\)</span> where <span class="math">\(P_i = \{A \rightarrow h_i(\alpha): (A\rightarrow \alpha) \in R\}\)</span>. An <strong>Output translation grammar</strong> <span class="math">\(TG\)</span> is a Context-Free Grammar <span class="math">\(G_o = (N,\Sigma,P_o,S)\)</span> where <span class="math">\(P_o = \{A \rightarrow h_o(\alpha):(A\rightarrow \alpha) \in R\}\)</span></p>
<p>A CFG <span class="math">\(G = (N,\Sigma \cup D, R,S)\)</span> is a <strong>characteristic grammar of translation grammar</strong> <span class="math">\(TG = (N,\Sigma,D,R,S)\)</span>, in the same way, <span class="math">\(L(G)\)</span> is the <strong>characteristic language of translation</strong> <span class="math">\(Z(TG)\)</span> and <span class="math">\(w\in L(G)\)</span> is a <strong>characteristic sentence of pair</strong> <span class="math">\((x,y)\)</span></p>
<p>A <strong>regular translation grammar</strong> is a <span class="math">\(TG = (N,\Sigma,D,R,S)\)</span> such that all the rules are of the form:</p>
<div class="math">
\[
\array{
A \rightarrow axB\\
A\rightarrow ax\\
S\rightarrow \epsilon
}
\]</div>
<p>Where <span class="math">\(A,B \in N, a \in \Sigma, x \in D^*\)</span>, and in the case of the last rule, <span class="math">\(S\)</span> cannot be in the right side of any other rule.</p>
<h2 id="finite-transducers">Finite Transducers</h2>
<p>A finite transducer is a sextuple <span class="math">\(FT = (Q,\Sigma,D,\delta,q_0,F)\)</span> where:</p>
<ul>
<li><span class="math">\(Q\)</span> is a finite set of states</li>
<li><span class="math">\(\Sigma\)</span> is a finite set of input symbols</li>
<li><span class="math">\(D\)</span> is a finite set of output symbols</li>
<li><span class="math">\(\delta\)</span> is a mapping function from <span class="math">\(Q \times (\Sigma \cup\{\epsilon\})\)</span> into a set of finite subsets <span class="math">\(2^{Q \times D^*}\)</span></li>
<li><span class="math">\(q_0 \in Q\)</span> is the start state</li>
<li><span class="math">\(F \subseteq Q\)</span> is the set of final states</li>
</ul>
<p>There are two ways to represent the transition function. We will show now an example from the state <span class="math">\(S\)</span> with the input symbol <span class="math">\(a\)</span> to the state <span class="math">\(A\)</span> and output <span class="math">\(x\)</span>:</p>
<ul>
<li><p>Formal Representation:</p>
<div class="math">
\[
\delta(S,a) = \{(A,x)\}
\]</div>
</li>
<li><p>State Diagram:</p>
<div class="math">
\[
S \overset {a/x} \rightarrow |A|
\]</div>
</li>
</ul>
<p>A <strong>configuration of a transducer</strong> <span class="math">\(FT = (Q,\Sigma,D,\delta,q_0,F)\)</span> is a triple:</p>
<div class="math">
\[
(q,x,y) \in Q \times \Sigma^* \times D^*
\]</div>
<p>The initial configuration is described as <span class="math">\((q_0,x,\epsilon)\)</span>. We can also describe the relation <span class="math">\(\vdash_{FT}\)</span> in the same way as for the pushdown automata, as well as a move.</p>
<p>A translation if defined by a finite transducer <span class="math">\(FT = (Q,\Sigma,D,\delta,q_0,F)\)</span>:</p>
<div class="math">
\[
Z(FT) = \{(u,v):u \in \Sigma^*, v \in D^*, \exists q \in F, (q_0,u,\epsilon) \vdash_{FT}^*(q,\epsilon,v)\}
\]</div>
<p>The <strong>finite transducer is deterministic</strong> if for all states <span class="math">\(q \in Q\)</span> it holds:</p>
<div class="math">
\[
\array{
|\delta(q,a)| \le 1 &amp; \forall a \in \Sigma \land \delta(q,\epsilon) = \emptyset\\
|\delta(q,\epsilon)|\le 1 &amp; \forall a \in \Sigma \land \delta(q,a) = \emptyset
}
\]</div>
<p>Basically it is deterministic if it has no <span class="math">\(\epsilon\)</span>-transitions and for each state we can distinguish each exit transition by its input symbol.</p>
<h2 id="sequential-mapping">Sequential mapping</h2>
<p>A sequential mapping <span class="math">\(S\)</span> is a mapping such that:</p>
<ul>
<li>It preserves the length of the string.</li>
<li>If two inputs have the same prefix of length <span class="math">\(k\)</span>, then the corresponding output has the same identical prefixes of length of at least <span class="math">\(k\)</span> characters.</li>
</ul>
<h2 id="mealymoore-automaton">Mealy/Moore Automaton</h2>
<p>A <strong>Mealy Automaton</strong> <span class="math">\(M\)</span> is a sextuple <span class="math">\((Q,\Sigma,D,\delta,\lambda,q_0)\)</span> where:</p>
<ul>
<li><span class="math">\(Q\)</span> is a finite set of states</li>
<li><span class="math">\(\Sigma\)</span> is a finite set of input symbols</li>
<li><span class="math">\(D\)</span> is a finite set of output symbols</li>
<li><span class="math">\(\delta\)</span> is a mapping function from <span class="math">\(Q \times \Sigma\)</span> into <span class="math">\(Q\)</span> called <strong>transition function</strong>.</li>
<li><span class="math">\(\lambda\)</span> is a mapping function from <span class="math">\(Q\times \Sigma\)</span> into <span class="math">\(D\)</span> called <strong>output function</strong>.</li>
<li><span class="math">\(q_0 \in Q\)</span> is the start state.</li>
</ul>
<p>A <strong>Moore Automaton</strong> <span class="math">\(M\)</span> is a sextuple <span class="math">\((Q,\Sigma,D,\delta,\lambda,q_0)\)</span> where:</p>
<ul>
<li><span class="math">\(Q\)</span> is a finite set of states</li>
<li><span class="math">\(\Sigma\)</span> is a finite set of input symbols</li>
<li><span class="math">\(D\)</span> is a finite set of output symbols</li>
<li><span class="math">\(\delta\)</span> is a mapping function from <span class="math">\(Q \times \Sigma\)</span> into <span class="math">\(Q\)</span> called <strong>transition function</strong></li>
<li><span class="math">\(\lambda\)</span> is a mapping function from <span class="math">\(Q\)</span> into <span class="math">\(D\)</span> called <strong>output function</strong>.</li>
<li><span class="math">\(q_0 \in Q\)</span> is the start state</li>
</ul>
<p>The difference between the Mealy automaton and the Moore Automaton is that the output of the Mealy automaton is decided by the current state and current input, while in the Moore Automaton it is only affected by the current state.</p>
<p>Another difference between this automaton is that for the same input of length <span class="math">\(n\)</span>, the Moore automaton will output  a string of length <span class="math">\(n+1\)</span> while the Mealy automaton will output one with length <span class="math">\(n\)</span>. This difference is due to the fact that the Moore automaton first output symbol is not meaningful because it does not depend on the input.</p>
<p>The Moore and Mealy automata can be equivalent if the output of the Moore automaton is the same as the output from the mealy automaton if we exclude the first symbol of the Moore's output.</p>
<p>We can also define an <strong>extended transition function</strong> for both a Mealy and Moore automata as <span class="math">\(\hat \delta:Q \times \Sigma^* \mapsto Q\)</span> defined as:</p>
<div class="math">
\[
\array{
\hat \delta(q,\epsilon) = q &amp; \forall q \in Q\\
\hat\delta(q,a) = \delta(q,a) &amp; \forall a \in \Sigma, \forall q \in Q\\
\hat \delta (q,ua) = \delta (\hat \delta(q,u),a)&amp; \forall a \in \Sigma, \forall u \in \Sigma ^* , \forall q \in Q
}
\]</div>
<h3 id="transformations">Transformations</h3>
<p>For any Moore automaton <span class="math">\(M = (Q,\Sigma,D,\delta,\lambda,q_0)\)</span> there exists a Mealy automaton <span class="math">\(M'\)</span> with the same number of states such that:</p>
<div class="math">
\[
Z(M) = Z(M')
\]</div>
<p>The Mealy automaton is constructed as follows:</p>
<ul>
<li><span class="math">\(\lambda'(q,a) \leftarrow \lambda(\delta(q,a))\)</span>   <span class="math">\(\forall q \in Q, \forall a \in \Sigma\)</span></li>
<li><span class="math">\(M' = (Q,\Sigma,D,\delta,\lambda',q_0)\)</span></li>
</ul>
<p>Also, for any Mealy automaton <span class="math">\(M'=(Q',\Sigma,D,\delta',\lambda',q_0')\)</span> there exists a Moore automaton <span class="math">\(M\)</span> with <span class="math">\(|Q'||D|\)</span> states such that:</p>
<div class="math">
\[
Z(M') = Z(M)
\]</div>
<p>The Moore automaton is constructed as follows:</p>
<ul>
<li><span class="math">\(Q \leftarrow Q' \times D\)</span></li>
<li><span class="math">\(\delta((q,b),a) \leftarrow (\delta'(q,q),\lambda'(q,a))\)</span>   <span class="math">\(\forall q \in Q',\forall a \in \Sigma, \forall b\in D\)</span></li>
<li><span class="math">\(q_0 \leftarrow (q_0',c)\)</span> for some arbitrary fixed <span class="math">\(c\in D\)</span></li>
<li><span class="math">\(\lambda((q,b)) \leftarrow b\)</span>    <span class="math">\(\forall q \in Q',\forall b \in D\)</span></li>
<li><span class="math">\(M = (Q,\Sigma,D,\delta,\lambda,q_0)\)</span></li>
</ul>
<h2 id="pushdown-translation-automata">Pushdown Translation Automata</h2>
<p>The pushdown translation automaton is an octuple:</p>
<div class="math">
\[
\text{PTA} = (Q,\Sigma,G,D,\delta,q_0,Z_0,F)
\]</div>
<p>where</p>
<ul>
<li><span class="math">\(Q\)</span> is a finite set of states</li>
<li><span class="math">\(\Sigma\)</span> is a finite set of input symbols</li>
<li><span class="math">\(G\)</span> is a finite set of pushdown symbols</li>
<li><span class="math">\(D\)</span> is a finite set of output symbols</li>
<li><span class="math">\(\delta\)</span> is a mapping function from <span class="math">\(Q\times (\Sigma\cup\{\epsilon\}) \times G^*\)</span> to a set of subsets of <span class="math">\(Q\times G^* \times D^*\)</span></li>
<li><span class="math">\(q_0 \in Q\)</span> is the initial state</li>
<li><span class="math">\(Z_0 \in G\)</span> is the initial symbol of the pushdown store</li>
<li><span class="math">\(F \subseteq Q\)</span> is the set of final states</li>
</ul>
<p>The configuration of a <span class="math">\(\text{PTA} = (Q,\Sigma,G,D,\delta,q_0,Z_0,F)\)</span> is defined as a quadruple:</p>
<div class="math">
\[
(q,x,\alpha,y) \in Q \times \Sigma^*\times G^* \times D^*
\]</div>
<p>The moves and transition relation is defined in the same way as it previously was, but it is represented differently. In this example we are going from state <span class="math">\(S\)</span>, input <span class="math">\(a\)</span> and pushdown store symbol <span class="math">\(b\)</span> to state <span class="math">\(A\)</span>, output <span class="math">\(x\)</span> and pushing the symbol <span class="math">\(c\)</span> into the pushdown store:</p>
<ul>
<li>Formal Representation:</li>
</ul>
<div class="math">
\[
  \delta(S,a,b) = \{(A,c,x)\}
\]</div>
<ul>
<li>State Diagram:
<div class="math">
\[
S \overset {a,b/c,x} \longrightarrow |A|
\]</div>
</li>
</ul>
<p>The translation defined by a <span class="math">\(\text{PTA} = (Q,\Sigma,G,D,\delta,q_0,Z_0,F)\)</span> by a move into final state is a set of pairs:</p>
<div class="math">
\[
Z(\text{PTA}) = \{(x,y): x \in \Sigma^*, y\in D^*, \exists q \in F,\exists \alpha \in G^*,(q_0,x,Z_0,\epsilon)\vdash^*(q,\epsilon,\alpha,y)\}
\]</div>
<p>The translation defined by a <span class="math">\(\text{PTA} = (Q,\Sigma,G,D,\delta,q_0,Z_0,F)\)</span> by a move into configuration with empty pushdown store is a set of pairs:</p>
<div class="math">
\[
Z_\epsilon(\text{PTA}) = \{(x,y): x \in \Sigma^*, y\in D^*, \exists q \in Q,(q_0,x,Z_0,\epsilon)\vdash^*(q,\epsilon,\epsilon,y)\}
\]</div>
<p PTA="">A <strong>pushdown translation automaton is deterministic</strong> if the following holds for$\text = (Q,\Sigma,G,D,\delta,q_0,Z_0,F)$:</p>
<ul>
<li><span class="math">\(|\delta(q,a,\gamma)| \le 1\)</span>   <span class="math">\(\forall q \in Q,\forall a \in (\Sigma\cup\{\epsilon\}),\forall \gamma \in G^*\)</span></li>
<li>If <span class="math">\(\delta(q,a,\alpha) \neq \emptyset \land \delta(q,a,\beta)\neq \emptyset \land \alpha \neq \beta\)</span>, then <span class="math">\(\alpha\)</span> is not a prefix of <span class="math">\(\beta\)</span> and vice versa.</li>
<li>If <span class="math">\(\delta(q,a,\alpha) \neq \emptyset \land \delta(q,\epsilon,\beta)\neq \emptyset\)</span>, then <span class="math">\(\alpha\)</span> is not a prefix of <span class="math">\(\beta\)</span> and vice versa.</li>
</ul>
<p>We can also convert translation grammars into pushdown translation automata such that:</p>
<div class="math">
\[
Z_\epsilon(PTA) = Z(TG)
\]</div>
<p>For a given <span class="math">\(TG = (N,\Sigma,D,R,S)\)</span> we can construct</p>
<div class="math">
\[
PTA = (\{q\},\Sigma,N,N\cup \Sigma\cup D,D,\delta,q,S,\emptyset)
\]</div>
<p>where:</p>
<div class="math">
\[
\array{
\delta(q,\emptyset,A) \leftarrow \{(q,\alpha,\epsilon):(A\rightarrow \alpha)\in R\}&amp; \forall A\in N\\
\delta(q,a,a) \leftarrow \{(q,\epsilon,\epsilon)\}&amp; \forall a \in \Sigma \\
\delta(q,\epsilon,b) \leftarrow \{(a,\epsilon,b)\} &amp; \forall b \in D
}
\]</div>

</body>
</html>